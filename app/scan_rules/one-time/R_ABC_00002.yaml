---
version: 001
rule_id: R_ABC_00002

rule_meta:
  name: Identifies all resources created by Automation. Existing for more than 6 hours
  created_by: aarnav
  creation_timestamp: 15-Dec-2020  13:23:32 UTC+05:30   # ISO to  be decided
  cloud_type: GCLOUD
  tags:
    purpose: test
  labels:
    - happy_rule
    - good_rule

resource_types:
  - compute_v1_instances
  - sql_v1beta4_instances
  - redis_v1_instances
  - storage_v1_b

rule_lifecycle:
  type: ONE-TIME  # PERSIST /  ONE-TIME
  creation_epoch: 1587049503004  # 13 dig. milli secs
  expiry_time: 20-Dec-2020 13:42:34 UTC+05:30
  enable_time: 17-Dec-2020 13:42:34 UTC+05:30


filter_criterion:
  - filter_id: F0001
    filter_name: Filter 1
    filter_type: NAME # Must be one from pre-configured values
    required: false
    filter_data:
      name_regex: "terraform"

  - filter_id: F0002
    filter_name: Filter 6
    filter_type: TAG # Must be one from pre-configured values
    requried: false
    filter_data:
      key: 'created_by'  # Accepts valid python regex
      value: 'automation'  # Accepts regex # Optional

  - filter_id: F0003
    filter_name: Purpose Flow Logs Automation
    filter_type: TAG # Must be one from pre-configured values
    requried: false
    filter_data:
      key: 'purpose'  # Accepts valid python regex
      value: 'flowlogs-automation'  # Accepts regex # Optional

  - filter_id: F0005
    filter_name: Filter 5
    filter_type: AGE # Must be one from pre-configured values
    requried: false
    filter_data:
      age: 6
      unit: hours


filter_combination:
  join_rule: (F0005 and (F0001 or F0002) and not F0003)