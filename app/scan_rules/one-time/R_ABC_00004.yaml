---
version: 001
rule_id: R_ABC_00004

rule_meta:
  name: Qualify all resources that are don't have a dnd literal and have age > 24 hours
  created_by: aarnav
  creation_timestamp: 6-May-2020  15:23:32 UTC+05:30   # ISO to  be decided
  cloud_type: GCLOUD
  tags:
    purpose: test
  labels:
    - happy_rule
    - good_rule


rule_lifecycle:
  type: ONE-TIME  # PERSIST /  ONE-TIME
  creation_epoch: 1587049503004  # 13 dig. milli secs
  expiry_time: 20-Dec-2020 13:42:34 UTC+05:30
  enable_time: 17-Dec-2020 13:42:34 UTC+05:30


filter_criterion:
  - filter_id: F0001
    filter_name: Check resource with dnd_digit in them
    filter_type: NAME # Must be one from pre-configured values
    required: false
    filter_data:
      name_regex: 'dnd_\d+'

  - filter_id: F0002
    filter_name: Check all resource with tag like dnd_digit
    filter_type: TAG
    requried: false
    filter_data:
      key: 'dnd_\d+'

  - filter_id: F0003
    filter_name: Check all resource with tag like dnd_digit
    filter_type: TAG
    requried: false
    filter_data:
      key: '.*'
      value: 'dnd_\d+'

  - filter_id: F0004
    filter_name: Check all resources with age > 24 hours
    filter_type: AGE
    requried: false
    filter_data:
      age: 24
      unit: hours




filter_combination:
  join_rule: (F0004 and not (F0001 or F0002 or F0003))