---
version: 001
rule_id: R_ABC_00003

rule_meta:
  name: Resources that have a dnd literal and indicated time on it has expired
  created_by: aarnav
  creation_timestamp: 15-Dec-2020  13:23:32 UTC+05:30   # ISO to  be decided
  cloud_type: GCLOUD
  tags:
    purpose: test
  labels:
    - happy_rule
    - good_rule

resource_types:
  - compute_v1_instances
  - sql_v1beta4_instances
  - redis_v1_instances
  - storage_v1_b

rule_lifecycle:
  type: ONE-TIME  # PERSIST /  ONE-TIME
  creation_epoch: 1587049503004  # 13 dig. milli secs
  expiry_time: 20-Dec-2020 13:42:34 UTC+05:30
  enable_time: 17-Dec-2020 13:42:34 UTC+05:30


filter_criterion:
  - filter_id: F0001
    filter_name: Filter 7
    filter_type: AUTODETECT_DECLARED_EXPIRY # Must be one from pre-configured values
    requried: false
    filter_data:
      expected_regex: 'dnd_\d+'
      digit_unit: days  # Allowed Values: hours/days

  - filter_id: F0002
    filter_name: Filter 7
    filter_type: AUTODETECT_DECLARED_EXPIRY # Must be one from pre-configured values
    requried: false
    filter_data:
      expected_regex: 'dnd-\d+'
      digit_unit: days  # Allowed Values: hours/days

filter_combination:
  join_rule: (F0001)